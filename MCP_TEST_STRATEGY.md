# ChatSpatial MCP 测试策略

## 可用数据集

1. **ST_mouse_brain.h5ad** (9.7M) - 小鼠脑部空间转录组数据
2. **mop_sn_tutorial.h5ad** (1.9G) - 单核数据集（较大）
3. **slideseq_MOp_1217.h5ad** (923M) - Slide-seq 数据
4. **MOp_markers.csv** - 标记基因列表

## 测试策略

### 第一阶段：基础功能测试

1. **数据加载测试**
   ```
   加载 ST_mouse_brain.h5ad 数据集
   ```

2. **查看数据集信息**
   ```
   列出可用的数据集
   查看数据集的基本信息（细胞数、基因数等）
   ```

3. **数据预处理**
   ```
   对数据进行标准化
   进行质量控制
   ```

### 第二阶段：核心分析功能测试

1. **细胞类型注释**
   ```
   使用默认参数进行细胞类型注释
   可视化注释结果
   ```

2. **空间分析**
   ```
   识别空间可变基因
   进行空间自相关分析
   ```

3. **差异表达分析**
   ```
   在不同细胞类型间进行差异表达分析
   可视化差异表达结果
   ```

### 第三阶段：高级功能测试

1. **轨迹分析**
   ```
   运行RNA velocity分析
   构建发育轨迹
   ```

2. **空间域识别**
   ```
   使用 SpaGCN 或 BayesSpace 识别空间域
   可视化空间域结果
   ```

3. **细胞通讯分析**
   ```
   使用 LIANA+ 进行细胞通讯分析
   可视化配体-受体对
   ```

4. **富集分析**
   ```
   进行基因集富集分析
   使用 EnrichMap 进行空间富集分析
   ```

### 第四阶段：集成功能测试

1. **批次整合**
   ```
   如果有多个数据集，测试批次效应校正
   ```

2. **多模态分析**
   ```
   测试不同分析结果的整合
   ```

## 测试命令示例

在 Claude Desktop 中使用以下命令：

### 1. 加载数据
```
加载空间转录组数据 /Users/apple/Research/SpatialTrans_MCP/chatspatial/data/ST_mouse_brain.h5ad
```

### 2. 查看数据信息
```
显示所有可用的数据集
查看 dataset_1 的详细信息
```

### 3. 预处理
```
对 dataset_1 进行标准预处理，包括质量控制和标准化
```

### 4. 细胞类型注释
```
对 dataset_1 进行细胞类型注释，使用 scanpy 方法
```

### 5. 空间分析
```
识别 dataset_1 中的空间可变基因
```

### 6. 差异表达
```
在 dataset_1 中比较不同细胞类型的基因表达差异
```

### 7. 可视化
```
为 dataset_1 创建空间分布图，显示细胞类型
```

### 8. 富集分析
```
对 dataset_1 进行基因集富集分析，使用 GO_Biological_Process
```

## 注意事项

1. **从小数据集开始**：先用 ST_mouse_brain.h5ad (9.7M) 测试，确保功能正常
2. **逐步增加复杂度**：基础功能测试通过后再测试高级功能
3. **检查输出**：每个步骤都要检查是否有可视化结果和分析报告
4. **错误处理**：测试一些错误情况，如无效参数、不存在的数据集等
5. **性能监控**：注意大数据集的处理时间

## 期望结果

- 每个分析步骤都应该返回结果对象
- 可视化功能应该生成图像
- 错误情况应该有清晰的错误信息
- 资源列表应该随着分析进行而更新