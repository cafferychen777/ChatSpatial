name: Code Quality

on:
  workflow_dispatch:  # åªèƒ½æ‰‹åŠ¨è§¦å‘
  # push:
  #   branches: [ main ]
  # pull_request:
  #   branches: [ main ]

jobs:
  documentation:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Check documentation
      run: |
        echo "ğŸ“ Checking documentation completeness..."
        
        # Check for required files
        test -f README.md && echo "âœ… README.md exists" || echo "âš ï¸ README.md missing"
        test -f LICENSE && echo "âœ… LICENSE exists" || echo "âš ï¸ LICENSE missing"
      continue-on-error: true

  code-metrics:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.10"

    - name: Install analysis tools
      run: |
        python3 -m pip install --upgrade pip
        python3 -m pip install radon xenon bandit
      continue-on-error: true

    - name: Calculate code complexity
      run: |
        echo "ğŸ“Š Code Complexity Analysis"
        radon cc chatspatial/ --show-complexity --min B || echo "Complexity check done"
        radon mi chatspatial/ --show --min B || echo "Maintainability check done"
      continue-on-error: true

    - name: Security analysis
      run: |
        echo "ğŸ”’ Security Analysis"
        bandit -r chatspatial/ -f json -o bandit-report.json || echo "Security scan done"
      continue-on-error: true