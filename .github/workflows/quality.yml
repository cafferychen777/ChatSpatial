name: Code Quality

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  documentation:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Check documentation
      run: |
        echo "üìù Checking documentation completeness..."
        
        # Check for required files
        test -f README.md && echo "‚úÖ README.md exists" || echo "‚ö†Ô∏è README.md missing"
        test -f LICENSE && echo "‚úÖ LICENSE exists" || echo "‚ö†Ô∏è LICENSE missing"
      continue-on-error: true

  code-metrics:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.10"

    - name: Install analysis tools
      run: |
        python -m pip install --upgrade pip
        pip install radon xenon bandit
      continue-on-error: true

    - name: Calculate code complexity
      run: |
        echo "üìä Code Complexity Analysis"
        radon cc chatspatial/ --show-complexity --min B || echo "Complexity check done"
        radon mi chatspatial/ --show --min B || echo "Maintainability check done"
      continue-on-error: true

    - name: Security analysis
      run: |
        echo "üîí Security Analysis"
        bandit -r chatspatial/ -f json -o bandit-report.json || echo "Security scan done"
      continue-on-error: true